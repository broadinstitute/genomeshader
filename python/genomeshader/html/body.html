<div class="app sidebar-right-collapsed" style="position: relative; display: block;">
  <div class="sidebar" id="sidebar" style="position: absolute; left: 0; top: 0; bottom: 0; width: 240px; z-index: 100; pointer-events: auto;">
    <div class="sidebarContent">
    <div style="display: none;">
      <div class="sidebarHeader">
        <h3>Participant groups</h3>
      </div>

      <div class="group"><span>AFR</span><span class="pill">2634</span></div>
      <div class="group"><span>AMR</span><span class="pill">603</span></div>
      <div class="group"><span>EAS</span><span class="pill">1095</span></div>
      <div class="group"><span>EUR</span><span class="pill">5340</span></div>
      <div class="group"><span>SAS</span><span class="pill">328</span></div>
    </div>

    <!-- Sample Search Section -->
    <div class="sidebarHeader" style="margin-top: 20px;">
      <h3>Sample Search</h3>
    </div>

    <div id="sampleSearchSection" style="padding: 9px 10px; margin: 7px 0; border-radius: 10px; background: var(--panel2); margin-bottom: 20px;">
      <input type="text" id="sampleSearchInput" placeholder="Load sample by ID…" style="width: 100%; padding: 6px 8px; border: 1px solid var(--border2); border-radius: 6px; background: var(--panel); color: var(--text); font-size: 12px; box-sizing: border-box;">
      <div id="sampleSearchResults" style="display: none; max-height: 200px; overflow-y: auto; border: 1px solid var(--border2); border-radius: 6px; background: var(--panel); opacity: 1;"></div>
    </div>

    <div class="sidebarHeader" style="margin-top: 20px;">
      <h3>Selection</h3>
    </div>

    <!-- Context Indicator -->
    <div id="sampleContext" style="padding: 9px 10px; margin: 7px 0; border-radius: 10px; background: var(--panel2); font-size: 11px; color: var(--muted); display: none;">
    </div>

    <!-- Strategy Selection Section -->
    <div id="sampleStrategySection" style="padding: 9px 10px; margin: 7px 0; border-radius: 10px; background: var(--panel2); display: none;">
      <!-- Strategy Dropdown -->
      <div style="margin-bottom: 8px;">
        <label style="display: block; font-size: 11px; color: var(--muted); margin-bottom: 4px;">Strategy</label>
        <select id="sampleStrategy" disabled style="width: 100%; padding: 6px 8px; border: 1px solid var(--border2); border-radius: 6px; background: var(--panel); color: var(--text); font-size: 12px;">
          <option value="random">Random</option>
          <option value="best_evidence">Best evidence</option>
          <option value="most_diverse">Most diverse</option>
          <option value="compare_branches" disabled>Compare branches</option>
          <option value="carriers_controls">Carriers + controls</option>
        </select>
      </div>
      
      <!-- Combine Selection Toggle (AND/OR) -->
      <div style="margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
        <label style="font-size: 11px; color: var(--muted);">Combine selection:</label>
        <div style="display: flex; gap: 4px; background: var(--panel); border: 1px solid var(--border2); border-radius: 6px; padding: 2px;">
          <button id="combineAnd" class="combineToggle active" style="padding: 4px 8px; font-size: 11px; border: none; background: transparent; color: var(--text); border-radius: 4px; cursor: pointer;">AND</button>
          <button id="combineOr" class="combineToggle" style="padding: 4px 8px; font-size: 11px; border: none; background: transparent; color: var(--muted); border-radius: 4px; cursor: pointer;">OR</button>
        </div>
      </div>
      
      <!-- Number of Samples Input -->
      <div style="margin-bottom: 8px;">
        <label style="display: block; font-size: 11px; color: var(--muted); margin-bottom: 4px;"># samples</label>
        <div style="display: flex; gap: 8px; align-items: center;">
          <input type="range" id="sampleCountSlider" min="1" max="20" value="1" disabled style="flex: 1;">
          <input type="number" id="sampleCountInput" min="1" max="20" value="1" disabled style="width: 50px; padding: 4px 6px; border: 1px solid var(--border2); border-radius: 4px; background: var(--panel); color: var(--text); font-size: 12px; text-align: center;">
        </div>
      </div>
      
      <!-- Load Buttons -->
      <div style="display: flex; gap: 6px; margin-bottom: 8px;">
        <button id="loadSamplesReplace" disabled class="selectionBtn" style="flex: 1; padding: 6px 10px; font-size: 12px;">Load</button>
        <button id="loadSamplesAdd" disabled class="selectionBtn" style="flex: 1; padding: 6px 10px; font-size: 12px; display: none;">Load (add)</button>
      </div>
      
      <!-- Preview -->
      <div id="samplePreview" style="font-size: 11px; color: var(--muted); padding-top: 8px; border-top: 1px solid var(--border2); display: none;">
        <div style="margin-bottom: 4px; color: var(--text);">Matching samples:</div>
        <div id="samplePreviewList" style="color: var(--text);"></div>
      </div>
    </div>

    <div class="menu" id="ctxMenu" role="menu" aria-hidden="true">
      <div class="menuTitle">Display</div>
      <div class="menuItem" id="themeItem" role="menuitem">
        <span>Theme<span class="menuHotkey">T</span></span>
        <span class="menuRight" id="themeLabel">Auto</span>
      </div>

      <div class="menuItem" id="orientationItem" role="menuitem">
        <span>Orientation<span class="menuHotkey">O</span></span>
        <span class="menuRight" id="orientationLabel">Horizontal</span>
      </div>

      <div class="menuItem" id="variantLayoutModeItem" role="menuitem">
        <span>Variant Layout<span class="menuHotkey">V</span></span>
        <span class="menuRight" id="variantLayoutModeLabel">Equidistant</span>
      </div>

      <div class="menuItem" id="fullscreenItem" role="menuitem">
        <span>Full screen<span class="menuHotkey">F</span></span>
        <span class="menuRight" id="fullscreenLabel">Enter full screen</span>
      </div>

      <div class="menuTitle">Grouping</div>
      <div class="menuItem" role="menuitem">
        <span>Variable</span>
        <span class="menuRight">Super-pop</span>
      </div>
    </div>
    </div>

    <button class="gearBtn" id="menuBtn" title="Settings" aria-label="Settings">⚙︎</button>
  </div>

  <div class="main" id="main" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; z-index: 1;">
    <div class="tracks" id="tracksContainer">
      <svg id="tracksSvg" width="100%" height="100%"></svg>
      <canvas id="tracksWebGPU" class="webgpu-canvas" width="100%" height="100%"></canvas>
      <div id="trackControls"></div>
    </div>

    <div class="flow" id="flow">
      <canvas class="canvas" id="flowCanvas"></canvas>
      <canvas id="flowWebGPU" class="webgpu-canvas" width="100%" height="100%"></canvas>
      <svg class="overlay" id="flowOverlay"></svg>
    </div>

    <div class="hud" id="hud"></div>
    <div class="tooltip" id="tooltip"></div>
  </div>

  <div class="sidebar-right" id="sidebarRight" style="position: absolute; right: 0; top: 0; bottom: 0; width: 8px; z-index: 100; pointer-events: auto;">
    <div class="sidebar-right-content">
      <!-- Tab Content Area -->
      <div class="sidebar-right-tab-content">
        <div class="sidebarContent">
          <!-- Smart Tracks Tab -->
          <div class="tab-pane active" id="tab-smart-tracks" data-tab="smart-tracks">
            <div class="sidebarHeader" style="margin-top: 20px;">
              <h3>Smart Tracks</h3>
            </div>
            <div id="smartTracksList" style="padding: 0; margin: 0;">
              <!-- Smart Tracks will be rendered here -->
            </div>
          </div>
          
          <!-- UCSC Tracks Tab -->
          <div class="tab-pane" id="tab-ucsc-tracks" data-tab="ucsc-tracks">
            <div class="sidebarHeader" style="margin-top: 20px;">
              <h3>UCSC Tracks</h3>
            </div>
            <div id="ucscTracksContent" style="padding: 0; margin: 0;">
              <!-- UCSC Tracks content will be rendered here -->
            </div>
          </div>
          
          <!-- Genes Tab -->
          <div class="tab-pane" id="tab-genes" data-tab="genes">
            <div class="sidebarHeader" style="margin-top: 20px;">
              <h3>Genes</h3>
            </div>
            <div id="genesContent" style="padding: 0; margin: 0;">
              <!-- Genes content will be rendered here -->
            </div>
          </div>
          
          <!-- Variants Tab -->
          <div class="tab-pane" id="tab-variants" data-tab="variants">
            <div class="sidebarHeader" style="margin-top: 20px;">
              <h3>Variants</h3>
            </div>
            <div id="variantsContent" style="padding: 0; margin: 0;">
              <!-- Variants content will be rendered here -->
            </div>
          </div>
          
          <!-- Comments Tab -->
          <div class="tab-pane" id="tab-comments" data-tab="comments">
            <div class="sidebarHeader" style="margin-top: 20px;">
              <h3>Comments</h3>
            </div>
            <div id="commentsContent" style="padding: 0; margin: 0;">
              <!-- Comments content will be rendered here -->
            </div>
          </div>
        </div>
      </div>
      
      <!-- Command Strip -->
      <div class="sidebar-right-command-strip">
        <div class="command-strip-main">
          <button class="command-strip-icon active" data-tab="smart-tracks" title="Smart Tracks" aria-label="Smart Tracks">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
              <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
          </button>
          <button class="command-strip-icon" data-tab="ucsc-tracks" title="UCSC Tracks" aria-label="UCSC Tracks">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="3" y1="9" x2="21" y2="9"></line>
              <line x1="9" y1="21" x2="9" y2="9"></line>
            </svg>
          </button>
          <button class="command-strip-icon" data-tab="genes" title="Genes" aria-label="Genes">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
          </button>
          <button class="command-strip-icon" data-tab="variants" title="Variants" aria-label="Variants">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="8" y1="6" x2="21" y2="6"></line>
              <line x1="8" y1="12" x2="21" y2="12"></line>
              <line x1="8" y1="18" x2="21" y2="18"></line>
              <line x1="3" y1="6" x2="3.01" y2="6"></line>
              <line x1="3" y1="12" x2="3.01" y2="12"></line>
              <line x1="3" y1="18" x2="3.01" y2="18"></line>
            </svg>
          </button>
          <button class="command-strip-icon" data-tab="comments" title="Comments" aria-label="Comments">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
          </button>
        </div>
        
        <div class="command-strip-settings">
          <button class="command-strip-icon" data-tab="settings" title="Settings" aria-label="Settings">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M12 1v6m0 6v6m9-9h-6m-6 0H3m15.364 6.364l-4.243-4.243m-4.242 0L5.636 18.364M18.364 5.636l-4.243 4.243m0-4.242L5.636 5.636"></path>
            </svg>
          </button>
          <button class="command-strip-icon" data-tab="help" title="Help" aria-label="Help">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
          </button>
          <button class="command-strip-icon" data-tab="feedback" title="Feedback" aria-label="Feedback">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
              <line x1="9" y1="10" x2="15" y2="10"></line>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>